ggplot(plot_data, aes(log10(true_expan), true_era, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(log10(true_expan), era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(log10(true_expan), era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(aes(log10(true_expan), true_era) show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(log10(true_expan), era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(aes(x=log10(true_expan),y= true_era) show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(log10(true_expan), era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(aes(x=log10(true_expan),y= true_era), show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(log10(true_expan), era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(aes(x=log10(true_expan),y= true_era), show.legend = F, span=1) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(true_expan, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(aes(x=log10(true_expan),y= true_era), show.legend = F, span=1) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(true_expan, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(aes(x=true_expan, y= true_era), show.legend = F, span=1) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(true_expan, 2^(era_p), col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(aes(x=true_expan, y= 2^(true_era)), show.legend = F, span=1) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(surv_p, era_p - true_expan, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(surv_p, era_p - true_expan), level = 0.999, span = 0.1)
ggplot(plot_data, aes(surv_p, era_p - true_era, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(surv_p, era_p - true_era), level = 0.999, span = 0.1)
plot_data$surv_p
plot_data <- data %>% bind_cols(surv_p = surv_prediction$.pred, expan_p = expan_prediction$.pred, era_p = era_prediction$.pred) %>%
mutate(true_era = log2((1 - true_surv)/(true_surv*true_expan) + 1))
ggplot(plot_data, aes(true_expan, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
surv_prediction
surv_prediction <- predict(fit_surv, data)
data_df <- data %>% bind_cols(surv_prediction) %>% mutate(eras = log2((1 - true_surv)/(true_surv*true_expan) + 1)) %>%
select(-true_surv, -true_expan)
surv_prediction
set.seed(123)
data_split <- initial_split(data_df, prop = 0.7)
data_train <- training(data_split)
data_test <- testing(data_split)
recipe_eras <-  recipe(eras~. , data_train) %>% update_role(expan, surv, Var2, new_role = "ID") %>%
step_zv(all_predictors())
final_res_eras <- last_fit(final_xgb_eras, data_split)
collect_metrics(final_res_eras)
collect_predictions(final_res_eras) %>% ggplot(aes(eras, .pred)) + geom_abline(slope = 1, color = "red3", size = 1) +
geom_point()
fit_eras <- final_xgb_eras %>%
fit(data_train)
era_prediction <- predict(fit_eras, data_df)
plot_data <- data %>% bind_cols(surv_p = surv_prediction$.pred, expan_p = expan_prediction$.pred, era_p = era_prediction$.pred) %>%
mutate(true_era = log2((1 - true_surv)/(true_surv*true_expan) + 1))
ggplot(plot_data, aes(true_expan, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
# most important predictors
fit_eras %>%
pull_workflow_fit() %>%
vip::vip(geom = "point")
ggplot(plot_data, aes(surv_p, era_p - true_era, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(surv_p, era_p - true_era), level = 0.999, span = 0.1)
ggplot(plot_data, aes(true_era, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_abline(slope = 1, color = "red3", size = 1) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(surv_p, (era_p - true_era)^2), level = 0.999, span = 0.1)
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(surv_p, (era_p - true_era)^2), level = 0.999)
ggplot(plot_data, aes(true_surv, era_p - true_era, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(surv_p, era_p - true_era), level = 0.999, span = 0.1)
ggplot(plot_data, aes(true_surv, era_p - true_era, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(surv_p, era_p - true_era), level = 0.999, span = 0.1)
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(true_surv, (era_p - true_era)^2), level = 0.999)
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2, col = as_factor(round(expan, 8)))) + geom_smooth(inherit.aes = F,aes(true_surv, (era_p - true_era)^2), level = 0.999)
ggplot(plot_data, aes(log10(true_surv), (era_p - true_era)^2, col = as_factor(round(expan, 8)))) + geom_smooth(inherit.aes = F,aes(true_surv, (era_p - true_era)^2), level = 0.999)
ggplot(plot_data, aes(log10(true_surv), (era_p - true_era)^2, col = as_factor(round(expan, 8)))) + geom_smooth(), level = 0.999)
ggplot(plot_data, aes(log10(true_surv), (era_p - true_era)^2, col = as_factor(round(expan, 8)))) + geom_smooth( level = 0.999)
ggplot(plot_data, aes(log10(true_surv), (era_p - true_era)^2 )) + geom_smooth( level = 0.999)
saveRDS(fit_eras, "fit_eras.rds")
setwd("~/studia/zaklad/EC_rainbow/model_creation")
source('~/studia/zaklad/EC_rainbow/model_creation/graph_analysis_tools.R', echo = TRUE)
rangee <- seq(0.0001,1,length.out = 30)^1.7
ggplot(plot_data, aes(true_expan, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
pseudo_eras <- ggplot(data, aes(log2((1 - true_surv)/(true_surv*true_expan) + 1), skew, col = as_factor(round(surv,8)) ) ) +
geom_point(show.legend = F) +
geom_smooth( level = 0.8) + facet_wrap(~as_factor(round(surv,8)), scales = "free" )
#  pseudo(val+1) logarithm of nonliving cells/absolute expanding fraction  ~ skewness
pseudo_eras
pseudo_eras + ggsave("newstatistic_plt.png", type = "cairo",  width = 16, height = 12, dpi = 150)
pseudo_eras + ggsave("pseudo_eras_plt.png", type = "cairo",  width = 16, height = 12, dpi = 150)
ggplot(plot_data, aes(true_surv,(era_p - true_era)^2, col = as_factor(round(expan, 8)))) +
geom_point() + geom_smooth(inherit.aes = F,aes(surv_p, era_p - true_era), level = 0.999, span = 0.1)
ggplot(plot_data)+geom_smooth(inherit.aes = F,aes(surv_p, era_p - true_era), level = 0.999, span = 0.1)
ggplot(plot_data)+geom_smooth(inherit.aes = F,aes(surv_p, (era_p - true_era)^2), level = 0.999, span = 0.1)
ggplot(plot_data)+geom_smooth(inherit.aes = F,aes(surv_p, (era_p - true_era)^2))
ggplot(plot_data)+geom_smooth(inherit.aes = F,aes(true_surv, (era_p - true_era)^2))
ggplot(plot_data)+geom_smooth(inherit.aes = F,aes(true_surv, (era_p - true_era)^2)) + ylim(c(NA, 1))
ggplot(plot_data)+geom_smooth(inherit.aes = F,aes(true_surv, (era_p - true_era)^2)) + limits(c(NA, 1), "y")
library(ggplot2)
ggplot(plot_data)+geom_smooth(inherit.aes = F,aes(true_surv, (era_p - true_era)^2)) + ggplot2:::limits(c(NA, 1), "y")
ggplot(plot_data)+geom_smooth(inherit.aes = F,aes(true_surv, (era_p - true_era)^2)) + coord_cartesian(ylim = c(NA, 1))
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2))+geom_smooth() + coord_cartesian(ylim = c(NA, 1))+
geom_point(aes(color=as.factor(round(expan,8))))
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2))+geom_smooth() +
geom_point(aes(color=as.factor(round(expan,8))))
sd_loess <- loess(true_surv~ (era_p - true_era)^2, plot_data, model = T)
sd_loess$fitted
predict(sd_loess, plot_data$true_surv)
plot_data$true_surv
predict(sd_loess, newdata = plot_data$true_surv)
sd_loess
predict(sd_loess, newdata = list(true_surv=plot_data$true_surv))
plot_data$true_surv
data.class(plot_data$true_surv)
predict(sd_loess, newdata = list(true_surv = plot_data$true_surv))
predict(sd_loess, newdata = list(true_surv = plot_data$true_surv))
predict(sd_loess$model, newdata = plot_data$true_surv,)
sd_loess$model
sd_loess
predict(sd_loess$model, newdata = plot_data$true_surv)
predict(sd_loess, newdata = plot_data$true_surv)
plot_data %>% pull(true_surv)
sd_loess <- loess((era_p - true_era)^2~ true_surv, plot_data, span = 0.2)
predict(sd_loess, newdata = plot_data %>% pull(true_surv))
plot(plot_data %>% pull(true_surv), predict(sd_loess, newdata = plot_data %>% pull(true_surv)))
sd_loess <- loess((era_p - true_era)^2~ true_surv, plot_data, span = 0.5)
predict(sd_loess, newdata = plot_data %>% pull(true_surv))
plot(plot_data %>% pull(true_surv), predict(sd_loess, newdata = plot_data %>% pull(true_surv)))
sd_loess <- loess((era_p - true_era)^2~ true_surv, plot_data, span = 0.75)
predict(sd_loess, newdata = plot_data %>% pull(true_surv))
plot(plot_data %>% pull(true_surv), predict(sd_loess, newdata = plot_data %>% pull(true_surv)))
sd_loess <- loess((era_p - true_era)^2~ true_surv, plot_data, span = 0.5)
predict(sd_loess, newdata = plot_data %>% pull(true_surv))
plot(plot_data %>% pull(true_surv), predict(sd_loess, newdata = plot_data %>% pull(true_surv)))
saveRDS(sd_loess,"sd_loess.rds")
data_df
data_df$Var2
plot(plot_data %>% pull(true_surv), predict(sd_loess, newdata = seq(0,1,1000)))
plot( seq(0,1,1000), predict(sd_loess, newdata = seq(0,1,1000)))
predict(sd_loess, newdata = seq(0,1,1000))
predict(sd_loess, newdata = list(true_surv = seq(0,1,1000)))
seq(0,1,1000)
seq(0,1, length.out =  1000)
plot( seq(0,1,0.001), predict(sd_loess, newdata = seq(0,1,0.001)) )
lines( seq(0,1,0.001), predict(sd_loess, newdata = seq(0,1,0.001)) )
lines( seq(0,1,0.001), predict(sd_loess, newdata = seq(0,1,0.001)) )
df(seq(0,1,0.001), predict(sd_loess, newdata = seq(0,1,0.001)))
df(col1= seq(0,1,0.001),col2= predict(sd_loess, newdata = seq(0,1,0.001)))
data.frame(col1= seq(0,1,0.001),col2= predict(sd_loess, newdata = seq(0,1,0.001)))
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2))+geom_smooth() +
geom_point(aes(color=as.factor(round(expan,8)))) + geom_line(data = data.frame(col1= seq(0,1,0.001),col2= predict(sd_loess, newdata = seq(0,1,0.001))),
aes(col1,col2))
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2))+geom_smooth() +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd))
sd_pred <- data.frame(surv= seq(0,1,0.001), sd= predict(sd_loess, newdata = seq(0,1,0.001)))
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2))+geom_smooth() +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd))
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd))
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75)
ggplot(plot_data, aes(true_era, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(true_expan, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(true_expan, true_era, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(true_era, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_abline(slope = 1, color = "red3", size = 1) + facet_wrap(~as_factor(round(surv, 8)))
era_true_pred_plt <- ggplot(plot_data, aes(true_era, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_abline(slope = 1, color = "red3", size = 1) + facet_wrap(~as_factor(round(surv, 8)))
# erading fraction fit quality split by surviving fraction
era_true_pred_plt + ggsave("era_true_pred_plt.png", type = "cairo", width = 16, height = 12, dpi = 150)
ggplot(plot_data, aes(surv_p, log10(abs(era_p/true_era)), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, log10(abs(era_p/true_era)), col = as_factor(round(expan, 8)))) + geom_point() + ylim(c(NA,NA))
ggplot(plot_data, aes(surv_p, log10(abs(era_p/true_era)), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, log10(abs(era_p/true_era)) )) + geom_point()
ggplot(plot_data, aes(surv_p, (era_p/true_era)^2, col = as_factor(round(expan, 8)))) + geom_point()
(plot_data$true_era)
max(plot_data$true_era)
min(plot_data$true_era)
min(plot_data$era_p)
ggplot(plot_data, aes(surv_p, log10(abs(era_p-true_era)), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, log10(abs(era_p-true_era)+1), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, (era_p-true_era/abs(era_p-true_era)*log10(abs(era_p-true_era)+1), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, (era_p-true_era/abs(era_p-true_era))*log10(abs(era_p-true_era)+1), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, (era_p-true_era/abs(era_p-true_era))*log10(abs(era_p-true_era)), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, ((era_p-true_era)/abs(era_p-true_era))*log10(abs(era_p-true_era)), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, ((era_p-true_era)/abs(era_p-true_era))*log10(abs(era_p-true_era+1)), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, ((era_p-true_era)/abs(era_p-true_era)), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, ((era_p-true_era)/abs(era_p-true_era))*(log10(abs(era_p-true_era+1))-mean(log10(abs(era_p-true_era+1)))), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, (log10(abs(era_p-true_era+1))-mean(log10(abs(era_p-true_era+1)))), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, log10(abs(era_p-true_era+1)), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, log10(abs(era_p-true_era)+1), col = as_factor(round(expan, 8)))) + geom_point()
ggplot(plot_data, aes(surv_p, ((era_p-true_era)/abs(era_p-true_era))*log10(abs(era_p-true_era)+1), col = as_factor(round(expan, 8)))) + geom_point()
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, era_p - true_era )) +
geom_point(aes(col = as_factor(round(expan, 8)))) + geom_smooth(level = 0.999, span = 0.1)
erasd_surv_plt
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75)
erasd_surv_plt <- ggplot(plot_data, aes(surv_p,(era_p - true_era)^2)) +
geom_point(aes(col = as_factor(round(expan, 8)))) + geom_smooth(level = 0.999, span = 0.1)
erasd_surv_plt
sd_loess <- loess((era_p - true_era)^2~ surv_p, plot_data, span = 0.5)
saveRDS(sd_loess,"sd_loess.rds")
sd_pred <- data.frame(surv= seq(0,1,0.001), sd= predict(sd_loess, newdata = seq(0,1,0.001)))
ggplot(plot_data, aes(true_surv, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75)
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75)
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(col = as_factor(round(expan, 8))) ) + geom_smooth(, level = 0.999, span = 0.1)
erasd_surv_plt
erasd_surv_plt <- ggplot(plot_data, aes(-surv_p, (era_p - true_era)^2)) +
geom_point(aes(col = as_factor(round(expan, 8))) ) + geom_smooth(, level = 0.999, span = 0.1)
erasd_surv_plt
sd_loess <- loess((era_p - true_era)^2~ surv_p, plot_data, span = 0.5)
saveRDS(sd_loess,"sd_loess.rds")
sd_pred <- data.frame(surv= seq(0,1,0.001), sd= predict(sd_loess, newdata = seq(0,1,0.001)))
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75)
erasd_surv_plt + ggsave("erasd_surv_plt.png", type = "cairo", width = 10, height = 6, dpi = 200)
era_true_pred_plt <- ggplot(plot_data, aes(true_era, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_abline(slope = 1, color = "red3", size = 0.6) + facet_wrap(~as_factor(round(surv, 8)))
# erading fraction fit quality split by surviving fraction
era_true_pred_plt + ggsave("era_true_pred_plt.png", type = "cairo", width = 16, height = 12, dpi = 150)
ggplot(plot_data, aes(true_expan, era_p, col = as_factor(round(surv, 8)))) + geom_point(show.legend = F) +
geom_smooth(show.legend = F, span=0.2) + facet_wrap(~as_factor(round(surv, 8)))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_sqrt()
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_sqrt(trans = scales::reciprocal_trans())
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(trans = scales::reciprocal_trans())
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_sqrt(breaks_pretty(n=4))
breaks_pretty(n=4)
pretty(n=4)
pretty(5)
pretty(5, n = 4)
pretty(1:5, n = 4)
pretty(1:5, n = 2)
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(trans = "sqrt")
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + coord_trans(y="sqrt")
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(trans="sqrt",
breaks = trans_breaks("sqrt", function(x) sqrt(x)))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(trans="sqrt",
breaks = sqrt_trans() )
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(trans=sqrt_trans() )
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(trans=sqrt_trans(), breaks = 4)
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(trans=sqrt_trans())
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", 5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", n = 5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", n = 5, trans = function(x) {
round(srqt(x))^2
}))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", function(x) {
round(srqt(x))^2
}))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", function(x) {
round(sqrt(x))^2
}))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt",n = 5 ,function(x) {
round(sqrt(x))^2
}))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", n = 10 ,function(x) {
round(sqrt(x))^2
}))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", n = 10 ,function(x) {
round(sqrt(x))^2
})(c(0, round(max( (era_p - true_era)^2)) )) )
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", n = 10 ,function(x) {
round(sqrt(x))^2
})(c(0, round(max( (plot_data$era_p - plot_data$true_era)^2)) )) )
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt", n = 10 ,function(x) {
round(x/5)*5
})(c(0, round(max( (plot_data$era_p - plot_data$true_era)^2)) )) )
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt",,function(x) {
round(x/5)*5
})(c(0, round(max( (plot_data$era_p - plot_data$true_era)^2)) )) )
(plot_data$era_p - plot_data$true_era)^2
max((plot_data$era_p - plot_data$true_era)^2)
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt",n=5,function(x) {
round(x/5)*5
})(c(0, round(max( (plot_data$era_p - plot_data$true_era)^2)) )) )
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt",n=5,function(x) {
round(x/5)*5
}))
round(y/5)*5
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt",n=5,function(y) {
round(y/5)*5
}))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_continuous(trans=sqrt_trans(), breaks = trans_breaks("sqrt",n=5,function(y) {
round(y/5)*5
})(c(0,25)) )
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=trans_breaks("sqrt", function(x) round(sqrt(x),0), n=5)(c(0, 5)))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=trans_breaks("sqrt", function(x) round(sqrt(x),0), n=5)(c(0, 25)))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=trans_breaks("sqrt", function(x) round(sqrt(x),0), n=25)(c(0, 25)))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=trans_breaks("sqrt", function(x) round(x,0), n=5) (c(0, 25)))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=trans_breaks("sqrt", function(x) round(x/5,0), n=5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=trans_breaks("sqrt", function(x) round(x,0), n=5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=trans_breaks("sqrt", function(x) round(x/5,0)*5, n=5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=pretty_breaks("sqrt", function(x) round(x/5,0)*5, n=5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=pretty_breaks(10))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=pretty_breaks(8))
pretty_breaks(8)
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=breaks_width(8))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=breaks_width(8), lim=c(0,NA))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=breaks_pretty(n = 10)), lim=c(0,NA))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks=breaks_pretty(n = 10), lim=c(0,NA))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks = trans_breaks("log2", function(x) 2^x))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks = trans_breaks("log2", function(x) x^2))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks = trans_breaks("log2", function(x) sqrt(x)))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks = trans_breaks("log2", function(x) x/5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks = trans_breaks("log2", function(x) x*5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(breaks = trans_breaks("log2", function(x) x*3, n = 5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(lim=c(0,NA))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(lim=c(0,NA), breaks= c(0,1,2,4,6,8,12,16,20,24))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(lim=c(0,NA), breaks= log_breaks(base=2))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(lim=c(0,NA), breaks= c(0,1,2,4,6,8,12,16,20,24)) + + annotation_logticks()
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) +
scale_y_sqrt(lim=c(0,NA), breaks= c(0,1,2,4,6,8,12,16,20,24)) + annotation_logticks()
sd_loess <- loess((era_p - true_era)^2~ surv_p, plot_data, span = 0.5)
saveRDS(sd_loess,"sd_loess.rds")
sd_pred <- data.frame(surv= seq(0,1,0.001), sd= predict(sd_loess, newdata = seq(0,1,0.001)))
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75)
erasd_surv_plt + ggsave("erasd_surv_plt.png", type = "cairo", width = 10, height = 6, dpi = 200)
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(breaks=seq(0,25,5), trans = "sqrt")
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(breaks=seq(0,25,5), trans = sqrt_trans())
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(trans = sqrt_trans(), breaks=seq(0,25,5))
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_sqrt(breaks=seq(0,25,5))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(breaks=seq(0,25,5), trans = "sqrt")
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(breaks=seq(0,25,5), trans = "sqrt") +
coord_cartesian(ylim = c(0,NA))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(breaks=seq(0,25,5), trans = "sqrt") +
ylim(c(0,NA))
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(breaks=seq(0,25,5), trans = "sqrt", lim=c(0,NA))
seq(0,25,5)
ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75) + scale_y_continuous(lim=c(0,NA),breaks=seq(0,25,5), trans = "sqrt", )
erasd_surv_plt <- ggplot(plot_data, aes(surv_p, (era_p - true_era)^2)) +
geom_point(aes(color=as.factor(round(expan,8)))) +
geom_line(data = sd_pred, aes(surv,sd), col="red3", size=0.75)
erasd_surv_plt + ggsave("erasd_surv_plt.png", type = "cairo", width = 10, height = 6, dpi = 200)
hist_4<- c(0.9999958333506944, 0.9999944444753085, 1.076914792963131, 0.9999944444753085, 0.9999928571938772, 1.0624933594165038, 0.9473634349292899, 0.9999916667361106, 0.999990909173553, 0.999990909173553, 0.9999941176816607, 0.9230698225398267, 0.9999937500390623, 0.9999937500390623, 0.9999933333777775, 0.9999833336111065, 0.999990909173553, 1.0624933594165038, 0.9999944444753085, 0.9999944444753085, 1.0555496913906035, 0.9999952381179138, 0.9999933333777775, 0.9999916667361106, 0.9999888890123444, 0.9999916667361106, 1.0714209184220111, 1.0999890001099988, 0.9999950000249999, 1.0416623264069733, 0.9999954545661156, 0.999994736869806, 0.9999875001562482, 0.9999833336111065, 0.9999800003999919, 0.9999800003999919, 0.7999840003199935, 0.9999800003999919, 0.7999840003199935, 0.9999750006249843, 0.9999666677777408, 0.9999666677777408, 0.9999750006249843, 0.9999800003999919, 0.7499812504687382, 0.9999800003999919, 0.9999750006249843, 0.9999800003999919, 0.9999500024998751, 0.9999666677777408, 0.9999750006249843, 1.2499687507812305, 0.9999750006249843, 1.2499687507812305, 0.9999666677777408, 0.9999750006249843, 0.9999800003999919, 0.9999833336111065, 0.7499812504687382, 0.9999800003999919, 0.9999750006249843, 0.9999750006249843, 0.9999500024998751, 0.9999500024998751, 0.9999500024998751, 0.9999666677777408, 0.9999500024998751, 0.9999500024998751, 0.9999666677777408, 0.9999500024998751, 0.9999750006249843, 0.9999800003999919, 0.9999833336111065, 0.9999750006249843, 0.9999750006249843, 0.9999750006249843, 0.9999500024998751, 0.9999000099990001, 0.9999750006249843, 0.9999500024998751, 0.9999666677777408, 0.9999750006249843, 0.833319444675922, 0.9999800003999919, 0.9999800003999919, 0.9999666677777408, 0.9999800003999919, 0.9999500024998751, 0.9999750006249843, 0.9999666677777408, 0.9999750006249843, 0.9999000099990001, 0.9999000099990001, 0.9999500024998751, 0.9999500024998751, 0.9999666677777408, 0.9999750006249843, 0.9999500024998751, 0.9999750006249843, 0.9999800003999919, 0.9999833336111065, 0.9999750006249843, 0.9999666677777408, 0.9999833336111065, 0.833319444675922, 0.9999750006249843, 0.9999750006249843, 1.4999250037498126, 0.9999750006249843, 0.9999666677777408, 0.9999666677777408, 0.9999750006249843, 0.9999666677777408, 0.999985714489793, 1.1999760004799904, 0.9999833336111065, 0.9999800003999919, 0.9999750006249843, 0.9999800003999919, 0.6666444451851605, 0.9999666677777408, 0.833319444675922, 0.9999750006249843, 0.9999500024998751, 1.2499687507812305, 0.9999750006249843, 0.9999833336111065, 0.9999500024998751, 0.9999666677777408, 0.9999750006249843, 0.9999666677777408, 0.9999500024998751, 0.9999800003999919, 0.9999750006249843, 0.9999750006249843, 0.9999750006249843, 0.9999500024998751, 0.9999500024998751, 0.9999800003999919, 0.9999500024998751, 0.9999666677777408, 1.1428408165597634, 0.9999833336111065, 0.9999875001562482, 0.9999833336111065, 0.9999833336111065, 0.9999500024998751, 0.9999800003999919, 0.7499812504687382, 1.1428408165597634, 0.9999500024998751, 1.333288890370321)
hist(hist_4)
hist(hist_4, breaks = 20)
hist(hist_4, breaks = 50)
hist(hist_4, breaks = 50, color="blue3")
hist(hist_4, breaks = 50, col="blue3")
hist(hist_4, breaks = 50, col="blue4")
hist_3 <- c(0.9999958333506944, 0.9999944444753085, 1.076914792963131, 0.9999944444753085, 0.9999928571938772, 1.0624933594165038, 0.9473634349292899, 0.9999916667361106, 0.999990909173553, 0.999990909173553, 0.9999941176816607, 0.9230698225398267, 0.9999937500390623, 0.9999937500390623, 0.9999933333777775, 0.9999833336111065, 0.999990909173553, 1.0624933594165038, 0.9999944444753085, 0.9999944444753085, 1.0555496913906035, 0.9999952381179138, 0.9999933333777775, 0.9999916667361106, 0.9999888890123444, 0.9999916667361106, 1.0714209184220111, 1.0999890001099988, 0.9999950000249999, 1.0416623264069733, 0.9999954545661156, 0.999994736869806)
hist(hist_3, breaks = 20, col="blue4")
